# Features
add_header Permissions-Policy "accelerometer=(), autoplay=(), browsing-topics=(), camera=(), encrypted-media=(), gyroscope=(), magnetometer=(), microphone=(), midi=(), payment=*, xr-spatial-tracking=()" always;
add_header X-DNS-Prefetch-Control "on" always;
add_header X-Robots-Tag "all" always;

# HTTP3
#add_header Alt-Svc 'h3=":443";ma=86400,h3-29=":443";ma=86400,h3-27=":443";ma=86400' always;
#add_header x-quic 'h3' always;

# Cache Headers
# Note: When Cloudflare caching is enabled, this header may show MISS even though Nginx has cached the response internally. Cloudflare caches the initial response, so the cache status shown here may not reflect the actual Nginx cache state.
add_header X-FastCGI-Cache "$upstream_cache_status" always;

# Additional cache header for WordPress Site Health check compatibility - DISABLED FOR TESTING
#add_header X-Cache-Enabled "$loopback_header_x_cache_enabled" always;

# Powered By
#more_set_headers "Server : Nginx"
#more_set_headers "X-Powered-By : EngineScript | EngineScript.com";

# Referrer Policy
add_header Referrer-Policy "unsafe-url" always;

# Security
add_header Strict-Transport-Security "max-age=63072000; preload" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-Frame-Options "SAMEORIGIN" always;
#add_header Content-Security-Policy "default-src 'self' https: data: 'unsafe-inline' 'unsafe-eval';" always;

# Resources
# https://www.eff.org/deeplinks/2021/03/googles-floc-terrible-idea
# https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy
# https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Public-Key-Pins
# https://scotthelme.co.uk/introducing-the-reporting-api-nel-other-major-changes-to-report-uri/
# https://docs.report-uri.com/setup/ect/
# https://github.com/w3c/webappsec-feature-policy/blob/master/features.md#fn1
# https://serverfault.com/questions/1153941/does-anyone-have-a-best-practices-guide-for-nginx-with-http3-quic/1172800#1172800